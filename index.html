<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ç‡∏≠‡πÄ‡∏û‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‚òÄÔ∏èüéµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 30px;
            padding: 0;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .form-content {
            padding: 30px 20px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        .input-group input[type="text"],
        .input-group input[type="email"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .input-group input[type="text"]:focus,
        .input-group input[type="email"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .time-period {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .time-period.morning {
            background: linear-gradient(135deg, #4bd752 0%, #4d5753 100%);
        }

        .time-period.afternoon {
            background: linear-gradient(135deg, hsl(64, 88%, 44%) 0%, hwb(58 4% 13%) 100%);
        }

        .time-period.evening {
            background: linear-gradient(135deg, #26cdc5 0%, #d791a7 100%);
        }

        .time-period h3 {
            color: white;
            margin-bottom: 15px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: white;
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            color: white;
            font-weight: 500;
            font-size: 14px;
        }

        .song-input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            font-size: 13px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            margin-top: 10px;
        }

        .song-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .song-input:focus {
            outline: none;
            border-color: white;
            background: rgba(255, 255, 255, 0.3);
        }

        .remove-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
            padding: 0;
            margin-left: auto; /* Pushes button to the right */
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        button {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .btn-submit {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-reset {
            background: #f0f0f0;
            color: #333;
        }

        .btn-reset:hover:not(:disabled) {
            background: #e0e0e0;
        }

        .message {
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: center;
            display: none;
            font-weight: 600;
            word-break: break-word;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            display: block;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            display: block;
        }

        .emoji {
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéµ ‡∏Ç‡∏≠‡πÄ‡∏û‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h1>
            <p>‡∏Ç‡∏≠‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡πÄ‡∏û‡∏•‡∏á‡∏ô‡∏∞!</p>
        </div>

        <form id="musicForm" class="form-content">
            <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏Ç‡∏≠ -->
            <div class="input-group">
                <label for="name">‡∏ä‡∏∑‡πà‡∏≠ *</label>
                <input type="text" id="name" name="name" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" required>
            </div>

            <div class="input-group">
                <label for="email">‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
                <input type="email" id="email" name="email" placeholder="your.email@example.com" required>
            </div>

            <!-- ‡πÄ‡∏û‡∏•‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ä‡πâ‡∏≤ -->
            <div class="time-period morning">
                <h3><span class="emoji">‚òÄÔ∏è</span> ‡πÄ‡∏û‡∏•‡∏á‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ä‡πâ‡∏≤ (7:00 - 7:30)</h3>
                <div class="checkbox-group" id="morningContainer"></div>
                <input type="text" class="song-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏î Enter" data-period="morning">
            </div>

            <!-- ‡πÄ‡∏û‡∏•‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô -->
            <div class="time-period afternoon">
                <h3><span class="emoji">‚≠ê</span> ‡πÄ‡∏û‡∏•‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô (12:02 - 12:30)</h3>
                <div class="checkbox-group" id="afternoonContainer"></div>
                <input type="text" class="song-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏î Enter" data-period="afternoon">
            </div>

            <!-- ‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô -->
            <div class="time-period evening">
                <h3><span class="emoji">üåô</span> ‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô (17:20 ‡∏ô.)</h3>
                <div class="checkbox-group" id="eveningContainer"></div>
                <input type="text" class="song-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏î Enter" data-period="evening">
            </div>

            <div class="button-group">
                <button type="submit" class="btn-submit" id="submitBtn">‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á ‚úì</button>
                <button type="reset" class="btn-reset">‡∏•‡πâ‡∏≤‡∏á</button>
            </div>

            <div id="message" class="message"></div>
        </form>
    </div>

    <script>
        const form = document.getElementById('musicForm');
        const messageDiv = document.getElementById('message');
        const songInputs = document.querySelectorAll('.song-input');
        const submitBtn = document.getElementById('submitBtn');

        // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤
        const songs = {
            morning: [],
            afternoon: [],
            evening: []
        };
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function resetAll() {
            songs.morning = [];
            songs.afternoon = [];
            songs.evening = [];
            document.getElementById('morningContainer').innerHTML = '';
            document.getElementById('afternoonContainer').innerHTML = '';
            document.getElementById('eveningContainer').innerHTML = '';
        }
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listener ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏° Reset
        form.addEventListener('reset', function() {
            resetAll();
            showMessage('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß', ''); // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå message
        });

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö input ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á
        songInputs.forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && this.value.trim()) {
                    e.preventDefault();
                    const period = this.dataset.period;
                    const songName = this.value.trim();
                    
                    addSongToUI(period, songName);
                    
                    this.value = '';
                }
            });
        });

        function addSongToUI(period, songName) {
            const container = document.getElementById(period + 'Container');
            
            const checkboxItem = document.createElement('div');
            checkboxItem.className = 'checkbox-item';
            
            const newSongIndex = songs[period].length;
            songs[period].push(songName); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô Array

            checkboxItem.innerHTML = `
                <input type="checkbox" id="${period}_${newSongIndex}" name="${period}" value="${songName}" checked>
                <label for="${period}_${newSongIndex}">${songName}</label>
                <button type="button" class="remove-btn">‚úï</button>
            `;
            
            container.appendChild(checkboxItem);

            // Add event listener to the new remove button
            checkboxItem.querySelector('.remove-btn').addEventListener('click', function() {
                const songToRemove = songName;
                // ‡∏´‡∏≤ index ‡∏Ç‡∏≠‡∏á‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö
                const indexToRemove = songs[period].indexOf(songToRemove);
                if (indexToRemove > -1) {
                    songs[period].splice(indexToRemove, 1); // ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å array
                }
                container.removeChild(checkboxItem); // ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å UI
            });
        }
        
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // ‚≠ê ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á: ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≠‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á
            submitBtn.disabled = true;
            submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...';
            messageDiv.className = 'message'; // ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡πà‡∏≤

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÄ‡∏û‡∏•‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡πÄ‡∏û‡∏•‡∏á
            if (songs.morning.length === 0 && songs.afternoon.length === 0 && songs.evening.length === 0) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡πÄ‡∏û‡∏•‡∏á', 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = '‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á ‚úì';
                return;
            }

            const data = {
                timestamp: new Date().toLocaleString('th-TH'),
                name: name,
                email: email,
                morning: songs.morning.join(', '),
                afternoon: songs.afternoon.join(', '),
                evening: songs.evening.join(', ')
            };

            try {
                // üî¥ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÉ‡∏´‡πâ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà URL ‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢ URL ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy Apps Script ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î!
                const response = await fetch('https://script.google.com/macros/s/AKfycbyYBPAqr0PIC0E1TIa-J0qyNnRRsR8jdTnHTJI4coZLwS7LQA81ndh_-FJ1KBF7YS5k/exec' /* <--- ‡∏ß‡∏≤‡∏á URL ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà */, {
                    method: 'POST',
                    mode: 'cors', // Important for handling CORS
                    body: JSON.stringify(data),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    showMessage('‚úì ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞ üéµ', 'success');
                    form.reset(); // ‡πÉ‡∏ä‡πâ form.reset() ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡πÑ‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å event 'reset' ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ
                } else {
                    // ‚≠ê ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á: ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡πà‡∏≤‡∏ô Error ‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà Server ‡∏™‡πà‡∏á‡∏°‡∏≤
                    const errorData = await response.json();
                    const errorMessage = errorData.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ';
                    showMessage(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${errorMessage}`, 'error');
                }
            } catch (error) {
                // ‚≠ê ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Error ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
                console.error('Fetch Error:', error);
                showMessage(`‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS ‡∏´‡∏£‡∏∑‡∏≠ Network ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console`, 'error');
            } finally {
                // ‚≠ê ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á: ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
                submitBtn.disabled = false;
                submitBtn.textContent = '‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á ‚úì';
            }
        });

        function showMessage(text, type) {
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
        }
    </script>
</body>
</html>

